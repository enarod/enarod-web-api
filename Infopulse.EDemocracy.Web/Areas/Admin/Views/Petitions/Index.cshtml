@using Newtonsoft.Json
@model List<Infopulse.EDemocracy.Web.Areas.Admin.Models.ModeratedPetition>
@{
	ViewBag.Title = "Модерація петицій";
}



<div class="row">
	<h2 class="col-md-12">Модерація петицій</h2>
</div>

<div class="row">
	<div class="col-md-12">
		<table>
			<thead>
			<tr>
				<th></th>
				<th>ID петиції</th>
				<th>Назва</th>
				<th>Дата створення</th>
				<th>Модератор</th>
				<th>Дата</th>
			</tr>
			</thead>
			<tbody data-bind="foreach: petitions">
			<tr class="petition">
				<td><input type="checkbox" data-bind="checkedValue: $data, checked: $root.selectedPetitions"/></td>
				<td data-bind="text: ID"></td>
				<td data-bind="text: Subject"></td>
				<td data-bind="text: moment(CreatedDate).format('DD.MM.YYYY hh:mm')"></td>
				<td data-bind=""></td>
				<td data-bind=""></td>
			</tr>
			</tbody>
		</table>
	</div>
</div>

<div class="row">
	<div class="col-md-12">
		<button id="AssignToMe" data-bind="click: assignToMe">Взяти в роботу</button>
		<button id="ApprovePetitions" data-bind="click: approveSelectedPetitions">Підтвердити</button>
		<button id="RejectPetitions" data-bind="click: rejectSelectedPetitions">Відхилити</button>
		<button id="EscalatePetitions" data-bind="click: escalateSelectedPetitions">На розгляді</button>
	</div>
</div>

@*<script type="text/javascript">
	//function collectCheckedPetitions() {
	//	var params = [];

	//	var petitions = $('.petitionInfo');
	//	for (var i in petitions) {
	//		if (petitions.hasOwnProperty(i) && i !== 'selector') {
	//			var petitionInfo = $(petitions[i]);
	//			var isChecked = petitionInfo.is(':checked');

	//			if (isChecked) {
	//				params.push({
	//					IsChecked: isChecked,
	//					ID: parseInt(petitionInfo.attr('data-id'))
	//				});
	//			}
	//		}
	//	}

	//	return params;
	//}

	//$('#AssignToMe').click(function() {
	//	var params = collectCheckedPetitions();
	//	Moderation.post('petitions/assigntome', params, 'petitions', 'post');
	//});

	//$('#ApprovePetitions').click(function() {
	//	var params = collectCheckedPetitions();
	//	Moderation.post('petitions/ApprovePetitions', params, 'petitions', 'post');
	//});

	//$('#RejectPetitions').click(function() {
	//	var params = collectCheckedPetitions();
	//	Moderation.post('petitions/RejectPetitions', params, 'petitions', 'post');
	//});

	//$('#EscalatePetitions').click(function() {
	//	var params = collectCheckedPetitions();
	//	Moderation.post('petitions/EscalatePetitions', params, 'petitions', 'post');
	//});

</script>*@
<script type="text/javascript">
	var petitions = @Html.Raw(Json.Encode(Model));
</script>

<script src="~/Areas/Admin/app/petitionModeration.js"></script>
<script type="text/javascript" src="~/Areas/Admin/app/moderation.js"></script>

<script type="text/javascript">
	$(document).ready(function() {
		var viewModel = new AdminPetitionsViewModel();
		ko.applyBindings(viewModel);
		viewModel.init();
		viewModel.getPetitions();
	});
</script>

<div id="loginForm" title="Sign In">
	<div class="row">
		<p class="col-md-12">Please login</p>
	</div>
	<div class="row">
		<span class="col-md-3">Login</span>
		<input type="email" class="col-md-9"/>
	</div>
	<div class="row">
		<span class="col-md-3">Password</span>
		<input type="password" class="col-md-9" />
	</div>
	
	
	
</div>