@using Newtonsoft.Json
@*@model List<Infopulse.EDemocracy.Web.Areas.Admin.Models.ModeratedPetition>*@
@{
	ViewBag.Title = "Модерація петицій";
}



<div class="row">
	<h2 class="col-md-12">Модерація петицій</h2>
</div>

<div class="row">
	<div class="col-md-12">
		<table id="petitionList">
			<thead>
			<tr>
				<th></th>
				<th>ID петиції</th>
				<th>Назва</th>
				<th class="dataType-dateTime">Дата створення</th>
				<th>Модератор</th>
				<th class="dataType-dateTime">Дата допуску</th>
				<th class="petitionStatus">Статус</th>
			</tr>
			</thead>
			<tbody data-bind="foreach: petitions">
			<tr class="petition">
				<td><input type="checkbox" data-bind="checkedValue: $data, checked: $root.selectedPetitions"/></td>
				<td data-bind="text: ID"></td>
				<td data-bind="text: Subject"></td>
				<td data-bind="text: moment(CreatedDate).format('DD.MM.YYYY hh:mm')"></td>
				<td data-bind="text: ApproverEmail"></td>
				<td data-bind="text: ApprovedDate"></td>
				<td data-bind="text: AdminStatus"></td>
			</tr>
			</tbody>
		</table>
	</div>
</div>

<div class="row">
	<div class="col-md-12">
		<button id="AssignToMe" data-bind="click: assignToMe">Взяти в роботу</button>
		<button id="ApprovePetitions" data-bind="click: approveSelectedPetitions">Підтвердити</button>
		<button id="RejectPetitions" data-bind="click: rejectSelectedPetitions">Відхилити</button>
		<button id="EscalatePetitions" data-bind="click: escalateSelectedPetitions">На розгляді</button>
	</div>
</div>
@*<script type="text/javascript">
	var petitions = @Html.Raw(Json.Encode(Model));
</script>*@

<script src="~/Areas/Admin/app/moderation/PetitionsViewModel.js"></script>
<script src="~/Areas/Admin/app/AuthViewModel.js"></script>
<script src="~/Areas/Admin/app/utils.js"></script>

<script type="text/javascript">
	$(document).ready(function() {
		var viewModel = new PetitionsViewModel();
		ko.applyBindings(viewModel, $('div.body-content')[0]);
		viewModel.init();
		viewModel.getPetitions();

		var authViewModel = new AuthViewModel();
		ko.applyBindings(authViewModel, $('nav')[0]);
		authViewModel.init();
	});
</script>